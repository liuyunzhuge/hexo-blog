<!DOCTYPE html>
<html>
<head>
	<title>
		
	</title>

	<style type="text/css">
		body {
			width: 400px;
			height: 400px;
			margin: 100px auto;
			perspective: 1200px;
			position: relative;
			transform-style: preserve-3d;
		}

		#container {
			position: relative;
			width: 100%;
			height: 100%;
		}

		.box {
			display: block;
			width: 100%;
			height: 100%;
			position: absolute;
			top: 0;
			left: 0;
			opacity: .8;
			line-height: 400px;
			text-align: center;
			font-size: 100px;
			font-weight: bold;
			color: white;
			text-decoration: none;
		}


		.box:nth-child(3n+1) {
			background-color: #f77333;
		}

		.box:nth-child(3n+2) {
			background-color: blue;
		}

		.box:nth-child(3n+3) {
			background-color: green;
		}

	</style>
</head>
<body>
<form id="form" action="" onsubmit="return false">
	<div><label>边数：</label><input type="number" value="3" name="sides" placeholder="输入正多边形边数">
		<button type="button" onclick="makePolygon()">重新生成</button></div>
</form>
<div id="container">
</div>
<div>
	<button type="button" onclick="left()">left</button>
	<button type="button" onclick="right()">right</button>
</div>
<script type="text/javascript">
	var form = document.getElementById('form');
	var container = document.getElementById('container');
	var polygon = null;

	function generate(){
		var sides = parseInt(form.sides.value);
		var degree = 360 / sides;
		var translateZ = container.getBoundingClientRect().width / 2 * Math.tan((90 - degree/2) * Math.PI / 180);

		container.innerHTML = '';

		var rotateMap = {};

		var html = [];
		for(var i = 0; i < sides; i++) {
			rotateMap[i] = rotateMap[i-1] !== undefined ? (rotateMap[i-1] + degree) : 0;
			html.push('<a href="javascript:;" style="transform-origin:' +
			 	'50% 50% -'+ translateZ +'px' + '; transform: ' + 
			 	'translate(0, 0) rotateY('+rotateMap[i]+'deg); transition: all 1s' + 
				 ';" class="box">' + (i+1) + '</a>');
		}

		container.innerHTML = html.join('');

		return {
			rotateMap,
			degree
		}
	}

	polygon = generate();

	function makePolygon() {
		polygon = generate();
	}


	function left() {
		let keys = Object.keys(polygon.rotateMap);
		let boxes = [].slice.call(container.children);
		for(let k of keys) {
			polygon.rotateMap[k]-=polygon.degree;
			boxes[k].style.transform = 'translate(0, 0) rotateY('+polygon.rotateMap[k]+'deg)';
		}
	}

	function right() {
		let keys = Object.keys(polygon.rotateMap);
		let boxes = [].slice.call(container.children);
		for(let k of keys) {
			polygon.rotateMap[k]+=polygon.degree;
			boxes[k].style.transform = 'translate(0, 0) rotateY('+polygon.rotateMap[k]+'deg)';
		}
	}
</script>
</body>
</html>